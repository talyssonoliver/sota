<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>date-fns CDN Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 5px; }
        .error { background: #ffe6e6; }
        .success { background: #e6ffe6; }
    </style>
</head>
<body>
    <h1>date-fns CDN Compatibility Test</h1>
    
    <div class="test">
        <h3>Test 1: Current CDN (index.min.js)</h3>
        <div id="test1-result">Loading...</div>
        <script>
            window.onerror = function(message, source, lineno, colno, error) {
                if (source.includes('date-fns')) {
                    document.getElementById('test1-result').innerHTML = `<span style="color: red;">ERROR: ${message} at line ${lineno}</span>`;
                    document.getElementById('test1-result').parentElement.className = 'test error';
                }
                return false;
            };
        </script>
        <script src="https://cdn.jsdelivr.net/npm/date-fns@2.29.3/index.min.js"></script>
        <script>
            try {
                if (typeof dateFns !== 'undefined') {
                    document.getElementById('test1-result').innerHTML = '<span style="color: green;">SUCCESS: date-fns loaded as dateFns</span>';
                    document.getElementById('test1-result').parentElement.className = 'test success';
                } else {
                    document.getElementById('test1-result').innerHTML = '<span style="color: orange;">WARNING: date-fns loaded but not available as dateFns</span>';
                }
            } catch (e) {
                document.getElementById('test1-result').innerHTML = `<span style="color: red;">ERROR: ${e.message}</span>`;
                document.getElementById('test1-result').parentElement.className = 'test error';
            }
        </script>
    </div>

    <div class="test">
        <h3>Test 2: Alternative CDN (unpkg)</h3>
        <div id="test2-result">Loading...</div>
        <script src="https://unpkg.com/date-fns@2.29.3/index.js"></script>
        <script>
            try {
                document.getElementById('test2-result').innerHTML = '<span style="color: green;">SUCCESS: Alternative CDN loaded without errors</span>';
                document.getElementById('test2-result').parentElement.className = 'test success';
            } catch (e) {
                document.getElementById('test2-result').innerHTML = `<span style="color: red;">ERROR: ${e.message}</span>`;
                document.getElementById('test2-result').parentElement.className = 'test error';
            }
        </script>
    </div>

    <div class="test">
        <h3>Test 3: Without date-fns (Check if error persists)</h3>
        <div id="test3-result">Loading dashboard without date-fns...</div>
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
        <script src="enhanced_dashboard.js"></script>
        <script>
            try {
                if (typeof DashboardManager !== 'undefined') {
                    document.getElementById('test3-result').innerHTML = '<span style="color: green;">SUCCESS: Dashboard loaded without date-fns</span>';
                    document.getElementById('test3-result').parentElement.className = 'test success';
                } else {
                    document.getElementById('test3-result').innerHTML = '<span style="color: red;">ERROR: Dashboard failed to load</span>';
                    document.getElementById('test3-result').parentElement.className = 'test error';
                }
            } catch (e) {
                document.getElementById('test3-result').innerHTML = `<span style="color: red;">ERROR: ${e.message}</span>`;
                document.getElementById('test3-result').parentElement.className = 'test error';
            }
        </script>
    </div>
</body>
</html>
